)
library(manipulate)
library(ggplot2)
mu0 = 30
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma=slider(1,10,step=1,initial=4),
mua=slider(30,35,step=1,initial=32),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = 30
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma=slider(1,mu0,step=1,initial=4),
mua=slider(mu0,mu0+3*sigma,step=1,initial=mu0+sigma),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = 30
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma <- slider(1,mu0,step=1,initial=4),
mua=slider(mu0,mu0+3*sigma,step=1,initial=mu0+sigma),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = 30
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma = slider(1,mu0,step=1,initial=4),
mua=slider(mu0,3*mu0,step=1,initial=mu0),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = 30
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma = slider(1,mu0,step=1,initial=4),
mua=slider(mu0,1.5*mu0,step=1,initial=mu0),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = 30
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma = slider(1,mu0,step=1,initial=1),
mua=slider(mu0,1.5*mu0,step=1,initial=mu0),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = -3
sigma0 = 1.5
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma0/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma = slider(1,mu0,step=1,initial=sigma0),
mua=slider(mu0,1.5*mu0,step=1,initial=mu0),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = -3
sigma0 = 1.5
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma0/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma = slider(1,mu0,step=1,initial=sigma0),
mua=slider(-abs(mu0),1.5*abs(mu0),step=1,initial=mu0),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
library(manipulate)
library(ggplot2)
mu0 = -3
sigma0 = 1.5
myplot <- function(sigma,mua,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma,mu0+3*sigma)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma0/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
manipulate(
myplot(sigma,mua,n,alpha),
sigma = slider(1,mu0,step=1,initial=sigma0),
mua=slider(-1.5*abs(mu0),1.5*abs(mu0),step=1,initial=mu0),
n=slider(1,50,step=1,initial=16),
alpha=slider(0.01,0.1,step=0.01,initial=0.05)
)
t.test.plot <- function(mu0,sigma0,mua,sigma,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma0,mu0+3*sigma0)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma0/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
}
t.test.plot(mu0=-3,sigma0=1.5,mua=1,sigma=1.8,n=9,alpha=0.05)
t.test.plot(mu0=-3,sigma0=1.5,mua=1,sigma=1.8,n=9,alpha=0.025)
t.test.plot <- function(mu0,sigma0,mua,sigma,n,alpha) {
g = ggplot(data.frame(mu=c(mu0-3*sigma0,mu0+3*sigma0)),aes(x=mu))
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mu0,sd=sigma0/sqrt(n)),
size=2,col="red")
g = g+stat_function(fun=dnorm,geom="line",
args=list(mean=mua,sd=sigma/sqrt(n)),
size=2,col="blue")
xitc = mu0+qnorm(1-alpha*sigma/sqrt(n))
g = g+geom_vline(xintercept=xitc,size=3)
g
xitc
}
t.test.plot(mu0=-3,sigma0=1.5,mua=1,sigma=1.8,n=9,alpha=0.025)
qt(0.95,99)
mu0=0
mua=0.01
sigma=0.04
n=100
alpha=0.05
pnorm(mu0 + qnorm(1-alpha) * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail =FALSE)
#Q8
mu0=0
mua=0.01
sigma=0.04
n=180
alpha=0.05
power=pnorm(mu0 + qnorm(1-alpha) * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail =FALSE)
mu0=0
mua=0.01
sigma=0.04
n=180
alpha=0.05
power=pnorm(mu0 + qnorm(1-alpha) * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail =FALSE)
power
mu0=0
mua=0.01
sigma=0.04
n=160
alpha=0.05
power=pnorm(mu0 + qnorm(1-alpha) * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail =FALSE)
power
mu0=0
mua=0.01
sigma=0.04
n=120
alpha=0.05
power=pnorm(mu0 + qnorm(1-alpha) * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail =FALSE)
power
mu0=0
mua=0.01
sigma=0.04
n=140
alpha=0.05
power=pnorm(mu0 + qnorm(1-alpha) * sigma/sqrt(n), mean = mua, sd = sigma/sqrt(n), lower.tail =FALSE)
power
qt(0.05,8)/3
23/0.6198493
mean=1100
std=37.10579
n=9
alpha=0.05
mean + c(-1, 1) * qt(1-alpha/2, n - 1) * std / sqrt(n)
(1100-1078)/(37.10579/3)
qt(0.975,8)
1.5^2+1.8^2
-12/sqrt(5.49)
sx=1.5
sy=1.8
nx=9
ny=9
df=(sx^2/nx+sy^2/ny)^2/((sx^2/nx)^2/(nx-1)+(sy^2/ny)^2/(ny-1))
df
mux=-3
muy=1
sx=1.5
sy=1.8
nx=9
ny=9
t <- (mux-muy-0)/(sx^2/nx+sy^2/ny)
t
df=(sx^2/nx+sy^2/ny)^2/((sx^2/nx)^2/(nx-1)+(sy^2/ny)^2/(ny-1))
df
qt(1-0.1/2,df)
qt(1-0.01/2,df)
qt(0.05,df)
qt(0.01,df)
qt(0.001,df)
?shuttle
data("shuttle")
data(shuttle)
data(shuttle)
library(MASS)
data(shuttle)
data(shuttle)
head(shuttle)
x <- data(shuttle)
head(x)
x <- shuttle
data(shuttle)
x <- shuttle
head(x)
fit <- glm(use~wind)
library(MASS)
data(shuttle)
x <- shuttle
head(x)
fit <- glm(use~windï¼Œdata=x)
fit <- lm(use~wind,data=x)
fit <- glm(use~wind,data=x)
head(x)
x$use[use=="auto"] <- 1
x[use=="auto"]$use <- 1
x[use==auto,]$use <- 1
x[x$use==auto,]$use <- 1
library(swirl)
swirl()
plot(child ~ parent, galton)
plot(jitter(child,4) ~ parent,galton)
regrline
| <- lm(child ~ parent, galton)
regeline <- lm(child ~ parent, galton)
regrline <- lm(child ~ parent, galton)
abline(regrline, lwd=3, col='red')
summary(regrline)
lm(child~parent,galton)
fit <- lm(child~parent,galton)
fit$residuals
summary(fit)
mean(fit$residuals)
cov(fit$residuals, galton$parent)
ols.ic <- fit$coef[1]
ols.slope <- fit$coef[2]
v
lhs-rhs
all.equal(lhs,rhs)
varchild <- galton$heights
varChild <- var(galton$child)
var(fit$residuals)
varRes <- var(fit$residuals)
varEst <- est(ols.slope)
varEst <- est(ols.slope,ols.ic)
varEst <- var(est(ols.slope, ols.ic))
all.equal(varChild,sum(varRes,varEst))
all.equal(varChild,varRes+varEst)
efit <- lm(accel ~ mag+dist, attenu)
efit <- lm(accel ~ mag+dist, attenu)
mean(efit$residuals)
attenu$mag
cov(efit$residuals, attenu$mag)
cov(efit$residuals, attenu$dist)
cor(gpa_nor,gch_nor)
l_nor<-lm(gpa_nor,gch_nor)
l_nor<-lm(gpa_nor~gch_nor)
l_nor<-lm(gch_nor~gpa_nor)
install.packages("shiny")
library(shiny)
help(shiny)
library(randomForest)
str(trainingData)
source('~/.active-rstudio-document', echo=TRUE)
summary(trainingData$num_window)
unqiue(trainingData$num_window)
unique(trainingData$num_window)
newdata$classePred <- predict(modFit,newdata[,1])
newdata$classePred <- predict(modFit,newdata[1,])
newdata$classePred <- predict(modFit,newdata)
source('~/.active-rstudio-document', echo=TRUE)
a <- training[1:20,]
View(a)
View(newdata)
setwd("C:/Users/Alan GZ Li/Documents/GitHub/Practical-Machine-Learning")
trainingData <- read.csv("./data/pml-training.csv",na.strings = c("","NA","#DIV/0!"))
trainingData<- trainingData[,-c(1:5)]
rownames(trainingData)<-NULL
a<-trainingData[1:20,]
View(a)
source('~/.active-rstudio-document', echo=TRUE)
View(newdata)
View(testing)
setwd("C:/Users/Alan GZ Li/Documents/GitHub/Practical-Machine-Learning")
setwd("C:/Users/Alan GZ Li/Documents/GitHub/Practical-Machine-Learning")
trainingData <- read.csv("./data/pml-training.csv",na.strings = c("","NA","#DIV/0!"))
trainingData<- trainingData[,-c(1:5)]
View(trainingData)
View(trainingData)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
newdata<- predictData[,-c(1:5,160)]
View(newdata)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
View(predictData)
rownames(newdata) <- predictData[,1]
newdata<- predictData[,-c(1:5,160)]
View(newdata)
library(caret)
inTrain <- createDataPartition(y=trainingData$classe,p=0.6, list=FALSE)
training <- trainingData[inTrain,]
testing <- trainingData[-inTrain,]
View(testing)
View(training)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
rownames(predictData) <- predictData[,1]
View(predictData)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
predictData$row.names <- predictData[,1]
newdata<- predictData[,-c(2:6,161)]
View(newdata)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
predictData$row.names <- predictData[,1]
newdata<- predictData[,-c(1:5,160)]
View(newdata)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
predictData$row.names <- predictData[,1]
View(predictData)
source('~/.active-rstudio-document', echo=TRUE)
View(testing)
class(testing)
head(testing)
head(newdata)
# predict outcome for predict data set using the model
newdata$classe <-"A"
pred <- createDataPartition(y=newdata$classe,p=1, list=FALSE)
newdata <- trainingData[pred,]
newdata$classePred <- predict(modFit,newdata)
table(predictData$problem_id,newdata$classePred)
head(newdata)
newdata$classe <-"A"
pred <- createDataPartition(y=newdata$classe,p=1, list=FALSE)
newdata <- trainingData[pred,-c("classe")]
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
newdata<- predictData[,-c(1:5,160)]
newdata$classe <-"A"
pred <- createDataPartition(y=newdata$classe,p=1, list=FALSE)
newdata <- trainingData[pred,-155]
newdata$classePred <- predict(modFit,newdata)
newdata$classePred
View(newdata)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
newdata<- predictData[,-c(1:5,160)]
newdata$classePred <- predict(modFit,newdata)
str(testing)
str(newdata)
?stringAsFactor
??stringAsFactor
setwd("C:/Users/Alan GZ Li/Documents/GitHub/Practical-Machine-Learning")
trainingData <- read.csv("./data/pml-training.csv",na.strings = c("","NA","#DIV/0!"),stringsAsFactors=FALSE)
trainingData<- trainingData[,-c(1:5)]
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
newdata<- predictData[,-c(1:5,160)]
source('~/.active-rstudio-document', echo=TRUE)
# predict outcome for predict data set using the model
newdata$classePred <- predict(modFit,newdata)
table(predictData$problem_id,newdata$classePred)
source('~/.active-rstudio-document', echo=TRUE)
modFit<-train(classe ~ ., data=training, method="rpart")
rf<-train(classe ~ ., data=training, method="rf", prox=TRUE, ntree=5)
source('~/.active-rstudio-document', echo=TRUE)
rf<-train(classe ~ ., data=training, method="rf", prox=TRUE, ntree=5)
setwd("C:/Users/Alan GZ Li/Documents/GitHub/Practical-Machine-Learning")
trainingData <- read.csv("./data/pml-training.csv",na.strings = c("","NA","#DIV/0!"))
fun <- function (x) {sum(is.na(x))}
NAcount <- apply(trainingData,2,fun)
NAcount <- as.data.frame(NAcount)
col<- which(NAcount$NAcount > length(trainingData)*0.95)
trainingData<- trainingData[,-c(1:5,col)]
predictData <- read.csv("./data/pml-testing.csv",na.strings = c("","NA","#DIV/0!"))
newdata<- predictData[,-c(1:5,col,160)]
testing <- trainingData[-inTrain,]
library(caret)
inTrain <- createDataPartition(y=trainingData$classe,p=0.6, list=FALSE)
training <- trainingData[inTrain,]
testing <- trainingData[-inTrain,]
library(party)
modFit <- ctree(classe~., data=training)
newdata$classePred <- predict(modFit,newdata)
modFit<-train(classe ~ ., data=training, method="rpart")
newdata$classePred <- predict(modFit,newdata)
table(predictData$problem_id,newdata$classePred)
summary(modFit)
plot(modFit$finalModel, uniform=TRUE)
install.packages("rattle")
install.packages("rattle")
install.packages("rattle")
library(rattle)
# plot the classification tree
rattle::fancyRpartPlot(modFit$finalModel)
fancyRpartPlot(modFit$finalModel)
rattle()
??ctree
?ctree
?predict
setwd("C:/Users/Alan GZ Li/Documents/GitHub/Practical-Machine-Learning")
trainingData <- read.csv("./data/pml-training.csv")
trainingData <- read.csv("./data/pml-training.csv",na.strings = c("","NA","#DIV/0!"))
